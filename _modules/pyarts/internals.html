

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyarts.internals &mdash; pyarts 2.3.1286 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pyarts
          

          
          </a>

          
            
            
              <div class="version">
                2.3.1286
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyarts</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pyarts.internals</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyarts.internals</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Implementation of classes to handle various ARTS internal structures.</span>

<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">pyarts.constants</span> <span class="k">as</span> <span class="nn">constants</span>
<span class="kn">import</span> <span class="nn">pyarts.spectroscopy</span> <span class="k">as</span> <span class="nn">spectroscopy</span>
<span class="kn">import</span> <span class="nn">pyarts</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="k">as</span> <span class="nn">_ip</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">wofz</span> <span class="k">as</span> <span class="n">_Faddeeva_</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span> <span class="k">as</span> <span class="n">_R</span>
<span class="kn">from</span> <span class="nn">numpy.polynomial</span> <span class="kn">import</span> <span class="n">Polynomial</span> <span class="k">as</span> <span class="n">_P</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ARTSCAT5&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Rational&#39;</span><span class="p">,</span>
           <span class="s1">&#39;PressureBroadening&#39;</span><span class="p">,</span>
           <span class="s1">&#39;LineMixing&#39;</span><span class="p">,</span>
           <span class="s1">&#39;PartitionFunctions&#39;</span><span class="p">,</span>
           <span class="s1">&#39;LineFunctionsData&#39;</span><span class="p">,</span>
           <span class="s1">&#39;read_hitran_online&#39;</span>
           <span class="p">]</span>

<span class="k">def</span> <span class="nf">read_hitran_online</span><span class="p">(</span><span class="n">hitran_file</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">1e9999</span><span class="p">,</span>
                       <span class="n">hit_tmp</span><span class="o">=</span><span class="s1">&#39;HITRAN2012.par&#39;</span><span class="p">,</span> <span class="n">remove_hit_tmp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">reset_qn</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Reads catalog from HITRAN online</span>
<span class="sd">    </span>
<span class="sd">    This function is meant for specific input, so failure is an option.  This</span>
<span class="sd">    code might also break in the future should HITRAN update their format again</span>
<span class="sd">    </span>
<span class="sd">    The format has to be [.par line, qns&#39;, qns&#39;&#39;] in that order</span>
<span class="sd">    </span>
<span class="sd">    There is a temporary file generated.  This must be named so that the ARTS</span>
<span class="sd">    function abs_linesReadFromHitran can read the file.  After the temporary</span>
<span class="sd">    file has been read by ARTS, the catalog is accessed for each line to set</span>
<span class="sd">    their quantum numbers of qns&#39; and qns&#39;&#39;.  Note that these are added as </span>
<span class="sd">    additions to existing numbers.  Caveats follow.</span>
<span class="sd">    </span>
<span class="sd">    The following qunatum numbers are ignored at present:</span>
<span class="sd">        kronigParity</span>
<span class="sd">        </span>
<span class="sd">        ElecStateLabel</span>
<span class="sd">        </span>
<span class="sd">    The following are reinterpreted for ARTS:</span>
<span class="sd">        v to v1</span>
<span class="sd">        </span>
<span class="sd">        nuclearSpinRef to F</span>
<span class="sd">        </span>
<span class="sd">    The following are given values despite having none:</span>
<span class="sd">        parity=- is set as -1</span>
<span class="sd">        </span>
<span class="sd">        parity=+ is set as +1</span>
<span class="sd">        </span>
<span class="sd">    All other variables are written to verbatim.  This means that if ARTS does</span>
<span class="sd">    not have the quantum number keys prescribed, the catalog that is produced</span>
<span class="sd">    will not be possible to read with ARTS.  Take care!</span>
<span class="sd">    </span>
<span class="sd">    Input:</span>
<span class="sd">        hitran_file:</span>
<span class="sd">            a file generated from hitran.org</span>
<span class="sd">        </span>
<span class="sd">        fmin:</span>
<span class="sd">            fmin in abs_linesReadFromHitran</span>
<span class="sd">        </span>
<span class="sd">        fmax:</span>
<span class="sd">            fmax in abs_linesReadFromHitran</span>
<span class="sd">        </span>
<span class="sd">        hit_tmp:</span>
<span class="sd">            temporary filename for abs_linesReadFromHitran</span>
<span class="sd">        </span>
<span class="sd">        remove_hit_tmp:</span>
<span class="sd">            Flag to remove or not the file hit_tmp using os.remove</span>
<span class="sd">    </span>
<span class="sd">    Output:</span>
<span class="sd">        ARTSCAT5 catalog of lines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">hitran_file</span> <span class="o">==</span> <span class="n">hit_tmp</span><span class="p">,</span> <span class="s2">&quot;Must have separate files&quot;</span>

    <span class="c1"># setup a quiet workspace</span>
    <span class="kn">from</span> <span class="nn">pyarts.workspace</span> <span class="kn">import</span> <span class="n">Workspace</span>
    <span class="n">arts</span> <span class="o">=</span> <span class="n">Workspace</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># read a file from hitran of format [par, qn upper, qn lower]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">hitran_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">par_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">up_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lo_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">par_data</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">up_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">))</span>
        <span class="n">lo_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">))</span>
        <span class="n">lo_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">par_data</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Create a temporary file and read it into arts</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">hit_tmp</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">par_data</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">arts</span><span class="o">.</span><span class="n">abs_linesReadFromHitran</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">hit_tmp</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span>
                                 <span class="n">fmax</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">fmax</span><span class="p">))</span>

    <span class="c1"># delete previous file</span>
    <span class="k">if</span> <span class="n">remove_hit_tmp</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">hit_tmp</span><span class="p">)</span>

    <span class="c1"># replace quantum numbers by</span>
    <span class="n">arts</span><span class="o">.</span><span class="n">abs_linesNewestArtscatFromLegacyCatalog</span><span class="p">()</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">pyarts</span><span class="o">.</span><span class="n">abs_lines</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">as_ARTSCAT5</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cat</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">reset_qn</span><span class="p">:</span>
            <span class="n">cat</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyarts</span><span class="o">.</span><span class="n">catalogues</span><span class="o">.</span><span class="n">QuantumNumberRecord</span><span class="p">(</span><span class="n">arts</span><span class="o">.</span><span class="n">catalogues</span><span class="o">.</span><span class="n">QuantumNumbers</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">arts</span><span class="o">.</span><span class="n">catalogues</span><span class="o">.</span><span class="n">QuantumNumbers</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">qn</span> <span class="ow">in</span> <span class="n">up_data</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">qn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;ElecStateLabel&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="s1">&#39;nuclearSpinRef&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;UP&#39;</span><span class="p">][</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;kronigParity&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="s1">&#39;parity&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;UP&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                    <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;UP&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;v&#39;</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;UP&#39;</span><span class="p">][</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;UP&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">qn</span> <span class="ow">in</span> <span class="n">lo_data</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">qn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;ElecStateLabel&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="s1">&#39;nuclearSpinRef&#39;</span> <span class="ow">in</span> <span class="n">qn</span><span class="p">:</span>
                <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;LO&#39;</span><span class="p">][</span><span class="s1">&#39;F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;kronigParity&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="s1">&#39;parity&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;LO&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                    <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;LO&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;v&#39;</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;LO&#39;</span><span class="p">][</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cat</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="s1">&#39;LO&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cat</span>


<span class="k">class</span> <span class="nc">LineFunctionsData</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LM</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">len_of_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;LM_AER&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">12</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;T0&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;T1&quot;</span><span class="p">,</span> <span class="s2">&quot;T3&quot;</span><span class="p">,</span> <span class="s2">&quot;T5&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;T2&quot;</span><span class="p">,</span> <span class="s2">&quot;T4&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">3</span>
    
    <span class="k">def</span> <span class="nf">fill_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">ndata</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">start</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;spec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">ndata</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">len_of_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;key&#39;</span><span class="p">])):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
                    <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">pos</span>

    <span class="k">def</span> <span class="nf">read_as_part_of_artscat5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LM</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_data</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_data_shape</span><span class="p">(),</span> <span class="n">j</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">len_of_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DP&#39;</span><span class="p">]:</span>
            <span class="n">shape_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LP&#39;</span><span class="p">,</span> <span class="s1">&#39;VP&#39;</span><span class="p">]:</span>
            <span class="n">shape_len</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SDVP&#39;</span><span class="p">]:</span>
            <span class="n">shape_len</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;HTP&#39;</span><span class="p">]:</span>
            <span class="n">shape_len</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown LS value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LS</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LM</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;#&#39;</span><span class="p">]:</span>
            <span class="n">mixing_len</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">LM</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LM1&#39;</span><span class="p">,</span> <span class="s1">&#39;INT&#39;</span><span class="p">,</span> <span class="s1">&#39;ConstG&#39;</span><span class="p">]:</span>
            <span class="n">mixing_len</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">LM</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LM2&#39;</span><span class="p">]:</span>
            <span class="n">mixing_len</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown LM value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LM</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mixing_len</span> <span class="o">+</span> <span class="n">shape_len</span>
        
    <span class="k">def</span> <span class="nf">set_data_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ndata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">len_of_data</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;spec&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{}}</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">ndata</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="p">[]}</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ndata</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ndata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">len_of_data</span><span class="p">()</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LS</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">LM</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">):</span>
            <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;spec&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndata</span><span class="p">):</span>
                <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;key&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
                <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">]:</span>
                    <span class="n">st</span> <span class="o">+=</span> <span class="n">z</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
        <span class="k">return</span> <span class="n">st</span>
    <span class="fm">__str__</span><span class="o">=</span><span class="fm">__repr__</span>


<div class="viewcode-block" id="ARTSCAT5"><a class="viewcode-back" href="../../generated/pyarts.internals.ARTSCAT5.html#pyarts.internals.ARTSCAT5">[docs]</a><span class="k">class</span> <span class="nc">ARTSCAT5</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class to contain ARTSCAT entries that can be accessed and  manipulated</span>

<span class="sd">        Access this data as</span>
<span class="sd">        (N, I, F0, S0, T0, E0, A, GL, GU, PB, QN, LM)  = ARTSCAT5[line_nr],</span>
<span class="sd">        where N is the name of the species, I is the AFGL isotopological code,</span>
<span class="sd">        F0 is the central frequency, S0 is the line strength at temperature T0,</span>
<span class="sd">        E0 is the lower energy state, A is the einstein coefficient, GL is the</span>
<span class="sd">        lower population constant, GU is the upper population constant, PB</span>
<span class="sd">        is a dictionary of the pressurebroadening scheme, QN is a</span>
<span class="sd">        QuantumNumberRecord, and LM is a line-mixing dictionary.  The</span>
<span class="sd">        dictionaries have keys corresponding to the ARTSCAT tags.  line_nr is</span>
<span class="sd">        an index absolutely less than len(self)</span>

<span class="sd">        Note:  Must be ARTSCAT5 line type or this will leave the class data</span>
<span class="sd">        in disarray.</span>

<span class="sd">        Future tech debt 1: The reading of tagged data will fail if major tags</span>
<span class="sd">        ever match minor tags (ex. PB is major, N2 is minor for PB, if LM ever</span>
<span class="sd">        gets the PB minor tag, then the method below will fail).</span>

<span class="sd">        Future tech debt 2: To add version number and make the class general,</span>
<span class="sd">        ARTSCAT3 only have minor tag N2 for line mixing and ARTSCAT4 has AP.</span>
<span class="sd">        These tags are however implicit and not written.  A</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_spec_ind</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_iso_ind</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_freq_ind</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_str_ind</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_t0_ind</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">_elow_ind</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">_ein_ind</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">_glow_ind</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">_gupp_ind</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">_pb_ind</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">_qn_ind</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">_lm_ind</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">_ze_ind</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">_lf_ind</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">_lsm_ind</span> <span class="o">=</span> <span class="mi">14</span>

<div class="viewcode-block" id="ARTSCAT5.__init__"><a class="viewcode-back" href="../../generated/pyarts.internals.ARTSCAT5.html#pyarts.internals.ARTSCAT5.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                <span class="s1">&#39;afgl&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">),</span>
                <span class="s1">&#39;str&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                <span class="s1">&#39;glow&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                <span class="s1">&#39;gupp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                <span class="s1">&#39;elow&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                <span class="s1">&#39;spec&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
                <span class="s1">&#39;ein&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])}</span>

        <span class="k">if</span> <span class="n">init_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">init_data</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_append_linestr_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linerecord_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes an arts-xml catalog string and appends info to the class data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="n">linerecord_str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">len_lr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">len_lr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="n">len_lr</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize line data&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">,</span>
                                       <span class="p">{</span><span class="s2">&quot;QN&quot;</span><span class="p">:</span> <span class="n">QuantumNumberRecord</span><span class="p">(),</span>
                                        <span class="s2">&quot;PB&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                               <span class="s2">&quot;Data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])},</span>
                                        <span class="s2">&quot;LM&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                               <span class="s2">&quot;Data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])},</span>
                                        <span class="s2">&quot;LF&quot;</span><span class="p">:</span> <span class="n">LineFunctionsData</span><span class="p">(),</span>
                                        <span class="s2">&quot;ZE&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                        <span class="s2">&quot;LSM&quot;</span><span class="p">:</span> <span class="p">{}})</span>

        <span class="n">spec</span> <span class="o">=</span> <span class="n">lr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">],</span>
                                                <span class="n">spec</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_spec_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">],</span>
                                                <span class="nb">int</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_iso_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">],</span>
                                                <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_freq_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">],</span>
                                               <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_str_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">],</span>
                                              <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_t0_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">],</span>
                                                <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_elow_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">],</span>
                                               <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ein_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">],</span>
                                                <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_glow_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">],</span>
                                                <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_gupp_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">lr</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">qnr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">ze</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;POL&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_lr</span><span class="p">:</span>
            <span class="n">this</span> <span class="o">=</span> <span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">this</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;QN&#39;</span><span class="p">,</span> <span class="s1">&#39;PB&#39;</span><span class="p">,</span> <span class="s1">&#39;LM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZE&#39;</span><span class="p">,</span> <span class="s1">&#39;LSM&#39;</span><span class="p">,</span> <span class="s1">&#39;LF&#39;</span><span class="p">]:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">this</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;QN&#39;</span><span class="p">:</span>
                <span class="n">qnr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">this</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ZE&#39;</span><span class="p">:</span>
                <span class="n">ze</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;POL&quot;</span><span class="p">:</span> <span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;GU&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                      <span class="s2">&quot;GL&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])}</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;LSM&#39;</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">nothing</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;LSM&#39;</span><span class="p">][</span><span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">lr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;LF&#39;</span><span class="p">:</span>
                <span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;LF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read_as_part_of_artscat5</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;Data&quot;</span><span class="p">],</span>
                                  <span class="nb">float</span><span class="p">(</span><span class="n">this</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">this</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuantumNumberRecord</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="n">qnr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;LM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LineMixing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;LM&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;PB&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">PressureBroadening</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;PB&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;ZE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ze</span>

    <span class="k">def</span> <span class="nf">_append_line_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends a line from data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_spec_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">],</span>
                                                <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_iso_ind</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">],</span>
                                                <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_freq_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">],</span>
                                               <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_str_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">],</span>
                                              <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_t0_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">],</span>
                                                <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_elow_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">],</span>
                                               <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ein_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">],</span>
                                                <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_glow_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">],</span>
                                                <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_gupp_ind</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">,</span>
                                       <span class="p">{</span><span class="s1">&#39;PB&#39;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_pb_ind</span><span class="p">],</span>
                                        <span class="s1">&#39;QN&#39;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_qn_ind</span><span class="p">],</span>
                                        <span class="s1">&#39;LM&#39;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_lm_ind</span><span class="p">],</span>
                                        <span class="s1">&#39;ZE&#39;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ze_ind</span><span class="p">],</span>
                                        <span class="s1">&#39;LF&#39;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_lf_ind</span><span class="p">],</span>
                                        <span class="s1">&#39;LSM&#39;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_lsm_ind</span><span class="p">]})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">F0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span>

    <span class="nd">@F0</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">F0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">S0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">]</span>

    <span class="nd">@S0</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">S0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Species</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Iso</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">T0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">g00</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">g0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">E0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_append_ArrayOfLineRecord_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array_of_linerecord</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends lines in ArrayOfLineRecord to ARTSCAT5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">array_of_linerecord</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;ARTSCAT-5&#39;</span><span class="p">,</span> <span class="s2">&quot;Only for ARTSCAT-5&quot;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">array_of_linerecord</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_linestr_</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_append_ARTSCAT5_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artscat5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends all the lines of another artscat5 to this</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">artscat5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_line_</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_testline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i_know_what_i_am_doing</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">i_know_what_i_am_doing</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">100e9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;afgl&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">626</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;str&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;glow&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;gupp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;elow&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;spec&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;ein&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">300</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">{</span><span class="s2">&quot;QN&quot;</span><span class="p">:</span> <span class="n">QuantumNumberRecord</span><span class="p">(</span><span class="n">as_quantumnumbers</span><span class="p">(</span><span class="s2">&quot;J 1&quot;</span><span class="p">),</span>
                                           <span class="n">as_quantumnumbers</span><span class="p">(</span><span class="s2">&quot;J 0&quot;</span><span class="p">)),</span>
                 <span class="s2">&quot;PB&quot;</span><span class="p">:</span> <span class="n">PressureBroadening</span><span class="p">([</span><span class="mf">10e3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">20e3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">,</span>
                                           <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                 <span class="s2">&quot;LM&quot;</span><span class="p">:</span> <span class="n">LineMixing</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])}])</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends data to ARTSCAT5.  Used at initialization</span>

<span class="sd">        Parameters:</span>
<span class="sd">            other (str, ARTSCAT5, ArrayOfLineRecord, tuple): Data to append,</span>
<span class="sd">            Must fit with internal structures.  Easiest to guarantee if other</span>
<span class="sd">            is another ARTSCAT5 or an ArrayOfLineRecord containing ARTSCAT-5</span>
<span class="sd">            data.</span>

<span class="sd">            sort: Sorts the lines by frequency if True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_linestr_</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ARTSCAT5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_ARTSCAT5_</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># For lines --- this easily fails</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_line_</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ArrayOfLineRecord</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_append_ArrayOfLineRecord_</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknown type&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_sanity_</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">sort</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sorts the ARTSCAT5 data by kind.  Set ascending to False for</span>
<span class="sd">        descending sorting</span>

<span class="sd">        Parameters:</span>
<span class="sd">            kind (str): The key to LineRecordData</span>

<span class="sd">            ascending (bool): True sorts ascending, False sorts descending</span>

<span class="sd">        Examples:</span>
<span class="sd">            Sort by descending frequnecy</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;C2H2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat.LineRecordData[&#39;freq&#39;]</span>
<span class="sd">            array([  5.94503434e+10,   1.18899907e+11,   1.78347792e+11, ...,</span>
<span class="sd">                     2.25166734e+12,   2.31051492e+12,   2.36933091e+12])</span>
<span class="sd">            &gt;&gt;&gt; cat.sort(ascending=False)</span>
<span class="sd">            &gt;&gt;&gt; cat.LineRecordData[&#39;freq&#39;]</span>
<span class="sd">            array([  2.36933091e+12,   2.31051492e+12,   2.25166734e+12, ...,</span>
<span class="sd">                     1.78347792e+11,   1.18899907e+11,   5.94503434e+10])</span>

<span class="sd">            Sort by line strength</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;C2H2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat.LineRecordData[&#39;str&#39;]</span>
<span class="sd">            array([  9.02281290e-21,   7.11410308e-20,   2.34380510e-19, ...,</span>
<span class="sd">                     4.77325112e-19,   3.56443438e-19,   2.63222798e-19])</span>
<span class="sd">            &gt;&gt;&gt; cat.sort(kind=&#39;str&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cat.LineRecordData[&#39;str&#39;]</span>
<span class="sd">            array([  9.02281290e-21,   7.11410308e-20,   2.34380510e-19, ...,</span>
<span class="sd">                     1.09266008e-17,   1.10644138e-17,   1.10939452e-17])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">kind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">,</span> <span class="s2">&quot;kind must be in LineRecordData&quot;</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">kind</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ascending</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">afgl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">upper_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lower_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes lines not within limits of kind</span>

<span class="sd">        This loops over all lines in self and only keeps those fulfilling</span>

<span class="sd">        .. math::</span>
<span class="sd">            l \\leq x \\leq u,</span>

<span class="sd">        where l is a lower limit, u is an upper limit, and x is a parameter</span>
<span class="sd">        in self.LineRecordData</span>

<span class="sd">        If spec and/or afgl are given, then the species and the afgl code of</span>
<span class="sd">        the line must match as well as the limit critera in order for the line</span>
<span class="sd">        to be removed</span>

<span class="sd">        Parameters:</span>
<span class="sd">            spec (str): Species string</span>

<span class="sd">            afgl (int): AFGL isotopologue code</span>

<span class="sd">            upper_limit (float): value to use for upper limit [-]</span>

<span class="sd">            lower_limit (float): value to use for lower limit [-]</span>

<span class="sd">            kind (str): keyword for determining x.  Must be key in</span>
<span class="sd">            self.LineRecordData</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: Only changes self</span>

<span class="sd">        Examples:</span>
<span class="sd">            Remove lines below 1 THz and above 1.5 THz</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;C2H2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat</span>
<span class="sd">            ARTSCAT-5 with 40 lines. Species: [&#39;C2H2&#39;]</span>
<span class="sd">            &gt;&gt;&gt; cat.remove(lower_limit=1000e9, upper_limit=1500e9)</span>
<span class="sd">            &gt;&gt;&gt; cat</span>
<span class="sd">            ARTSCAT-5 with 9 lines. Species: [&#39;C2H2&#39;]</span>

<span class="sd">            Remove weak lines</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;C2H2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat</span>
<span class="sd">            ARTSCAT-5 with 40 lines. Species: [&#39;C2H2&#39;]</span>
<span class="sd">            &gt;&gt;&gt; cat.remove(lower_limit=1e-18, kind=&#39;str&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cat</span>
<span class="sd">            ARTSCAT-5 with 31 lines. Species: [&#39;C2H2&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">upper_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lower_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> \
            <span class="s2">&quot;Cannot remove lines when the limits are undeclared&quot;</span>
        <span class="k">assert</span> <span class="n">kind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">,</span> <span class="s2">&quot;Needs kind in LineRecordData&quot;</span>

        <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spec</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">]:</span>
                <span class="k">return</span>  <span class="c1"># Nothing to remove</span>

        <span class="k">if</span> <span class="n">afgl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">afgl</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">]:</span>
                <span class="k">return</span>  <span class="c1"># Nothing to remove</span>

        <span class="n">remove_these</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">spec</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">afgl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">afgl</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">lower_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_limit</span><span class="p">:</span>
                    <span class="n">remove_these</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">upper_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_limit</span><span class="p">:</span>
                    <span class="n">remove_these</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">continue</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">remove_these</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_line</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ARTSCAT-5 with &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; lines. Species: &quot;</span> <span class="o">+</span> \
            <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">]))</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span>

    <span class="k">def</span> <span class="nf">_assert_sanity_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper to assert that the data is good</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">])</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">])</span> <span class="ow">and</span>    \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">])</span> <span class="ow">and</span>    \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">])</span> <span class="ow">and</span>     \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">])</span> <span class="ow">and</span>      \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">])</span> <span class="ow">and</span>    \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">])</span> <span class="ow">and</span>     \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">])</span> <span class="ow">and</span>    \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">])</span> <span class="ow">and</span>    \
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">),</span>                \
            <span class="bp">self</span><span class="o">.</span><span class="n">_error_in_length_message_</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a single line as tuple --- TODO: create LineRecord class?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;ein&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;glow&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;gupp&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pressurebroadening</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linemixing</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">zeemandata</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">linefunctionsdata</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineshapemodifiers</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_arts_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the arts-xml catalog string for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;@ &#39;</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_spec_ind</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_iso_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_freq_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_str_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_t0_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_elow_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ein_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_glow_ind</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_gupp_ind</span><span class="p">])</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pressurebroadening</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; PB &#39;</span> <span class="o">+</span> <span class="n">text</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; QN &#39;</span> <span class="o">+</span> <span class="n">text</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linemixing</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; LM &#39;</span> <span class="o">+</span> <span class="n">text</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zeemandata</span><span class="p">(</span><span class="n">index</span><span class="p">)[</span><span class="s1">&#39;POL&#39;</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; ZE &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeemandata</span><span class="p">(</span><span class="n">index</span><span class="p">)[</span><span class="s1">&#39;POL&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeemandata</span><span class="p">(</span><span class="n">index</span><span class="p">)[</span><span class="s1">&#39;GU&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeemandata</span><span class="p">(</span><span class="n">index</span><span class="p">)[</span><span class="s1">&#39;GL&#39;</span><span class="p">])</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linefunctionsdata</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; LF &#39;</span> <span class="o">+</span> <span class="n">text</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineshapemodifiers</span><span class="p">(</span><span class="n">index</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; LSM &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineshapemodifiers</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineshapemodifiers</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineshapemodifiers</span><span class="p">(</span><span class="n">index</span><span class="p">)[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">pressurebroadening</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return pressure broadening entries for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;PB&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">quantumnumbers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return quantum number entries for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">linemixing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return line mixing entries for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;LM&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">zeemandata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Zeeman entries for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;ZE&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">linefunctionsdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return line function entries for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;LF&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">lineshapemodifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return line mixing entries for line at index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;LSM&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_error_in_length_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Mis-matching length of vectors/lists storing line information&quot;</span>

    <span class="k">def</span> <span class="nf">as_ArrayOfLineRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Turns ARTSCAT5 into ArrayOfLineRecord that can be stored to file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_arts_str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_arts_str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">return</span> <span class="n">ArrayOfLineRecord</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;ARTSCAT-5&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ArrayOfLineRecord</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;ARTSCAT-5&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">changeForQN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">afgl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">information</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change information of a line according to identifiers</span>

<span class="sd">        Input:</span>
<span class="sd">            kind (str): kind of operation to be applied, either &#39;change&#39; for</span>
<span class="sd">            overwriting, &#39;add&#39; for addition (+=), &#39;sub&#39; for subtraction (-=),</span>
<span class="sd">            &#39;remove&#39; to remove matching lines, or &#39;keep&#39; to only keep matching</span>
<span class="sd">            lines</span>

<span class="sd">            qid (QuantumIdentifier): Identifier to the transition or energy</span>
<span class="sd">            level as defined in ARTS</span>

<span class="sd">            spec (str or NoneType):  Name of species for which the operation</span>
<span class="sd">            applies.  None means for all species.  Must be None if qid is given</span>

<span class="sd">            afgl (int or NoneType):  AFGL isotopologue integer for which the</span>
<span class="sd">            operation applies.  None means for all isotopologue.  Must be None</span>
<span class="sd">            if qid is given</span>

<span class="sd">            qns (dict, None, QuantumNumberRecord, QuantumNumbers):  The quantum</span>
<span class="sd">            numbers for which the operation applies.  None means all quantum</span>
<span class="sd">            numbers.  Can be level or transition.  Must be None if qid is given</span>

<span class="sd">            information (dict or NoneType):  None for kind &#39;remove&#39;. dict</span>
<span class="sd">            otherwise.  Keys in ARTSCAT5.LineRecordData for non-dictionaries.</span>
<span class="sd">            Use &#39;QN&#39; for quantum numbers, &#39;LM&#39; for line mixing, and &#39;PB&#39; for</span>
<span class="sd">            pressure-broadening.  If level QN-key, the data is applied for both</span>
<span class="sd">            levels if they match (only for &#39;QN&#39;-data)</span>

<span class="sd">        Output:</span>
<span class="sd">            None, only changes the class instance itself</span>

<span class="sd">        Examples:</span>
<span class="sd">            Add S = 1 to both levels quantum numbers by adding information to</span>
<span class="sd">            all lines</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;O2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat.quantumnumbers(0)</span>
<span class="sd">            UP v1 0 J 32 F 61/2 N 32 LO v1 0 J 32 F 59/2 N 32</span>
<span class="sd">            &gt;&gt;&gt; cat.changeForQN(information={&#39;QN&#39;: {&#39;S&#39;: 1}}, kind=&#39;add&#39;)</span>
<span class="sd">            &gt;&gt;&gt; cat.quantumnumbers(0)</span>
<span class="sd">            UP S 1 v1 0 J 32 F 61/2 N 32 LO S 1 v1 0 J 32 F 59/2 N 32</span>

<span class="sd">            Remove all lines not belonging to a specific isotopologue and band</span>
<span class="sd">            by giving the band quantum numbers</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;O2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat</span>
<span class="sd">            ARTSCAT-5 with 6079 lines. Species: [&#39;O2&#39;]</span>
<span class="sd">            &gt;&gt;&gt; cat.changeForQN(kind=&#39;keep&#39;, afgl=66, qns={&#39;LO&#39;: {&#39;v1&#39;: 0},</span>
<span class="sd">                                                           &#39;UP&#39;: {&#39;v1&#39;: 0}})</span>
<span class="sd">            &gt;&gt;&gt; cat</span>
<span class="sd">            ARTSCAT-5 with 187 lines. Species: [&#39;O2&#39;]</span>

<span class="sd">            Change the frequency of the 119 GHz line to 3000 THz by giving a</span>
<span class="sd">            full and unique quantum number match</span>

<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;O2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat.sort()</span>
<span class="sd">            &gt;&gt;&gt; cat.LineRecordData[&#39;freq&#39;]</span>
<span class="sd">            array([  9.00e+03,   2.35e+04,   4.01e+04, ...,   2.99e+12,</span>
<span class="sd">                     2.99e+12,   2.99e+12])</span>
<span class="sd">            &gt;&gt;&gt; cat.changeForQN(afgl=66, qns={&#39;LO&#39;: {&#39;v1&#39;: 0, &#39;J&#39;: 0, &#39;N&#39;: 1},</span>
<span class="sd">                                              &#39;UP&#39;: {&#39;v1&#39;: 0, &#39;J&#39;: 1, &#39;N&#39;: 1}},</span>
<span class="sd">                                information={&#39;freq&#39;: 3000e9})</span>
<span class="sd">            &gt;&gt;&gt; cat.sort()</span>
<span class="sd">            &gt;&gt;&gt; cat.LineRecordData[&#39;freq&#39;]</span>
<span class="sd">            array([  9.00e+03,   2.35e+04,   4.01e+04, ...,   2.99e+12,</span>
<span class="sd">                     2.99e+12,   3.00e+12])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">qid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">spec</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">afgl</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">qns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> \
                <span class="s2">&quot;Only one of qid or spec, afgl, and qns combinations allowed&quot;</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">qid</span><span class="o">.</span><span class="n">species</span>
            <span class="n">afgl</span> <span class="o">=</span> <span class="n">qid</span><span class="o">.</span><span class="n">afgl</span>
            <span class="n">qns</span> <span class="o">=</span> <span class="n">as_quantumnumbers</span><span class="p">(</span><span class="n">qns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qns</span> <span class="o">=</span> <span class="n">as_quantumnumbers</span><span class="p">(</span><span class="n">qns</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;remove&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">information</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;information not None for &#39;remove&#39;&quot;</span>
            <span class="n">remove_these</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">remove</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">change</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;change&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">information</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">,</span> <span class="s2">&quot;information is not dictionary&quot;</span>
            <span class="n">remove</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">change</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">information</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">,</span> <span class="s2">&quot;information is not dictionary&quot;</span>
            <span class="n">remove</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">change</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;sub&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">information</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">,</span> <span class="s2">&quot;information is not dictionary&quot;</span>
            <span class="n">remove</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">change</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;keep&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">information</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;information not None for &#39;keep&#39;&quot;</span>
            <span class="n">remove_these</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">remove</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">change</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid value for kind: </span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">remove</span> <span class="ow">or</span> <span class="n">change</span> <span class="ow">or</span> <span class="n">add</span> <span class="ow">or</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">sub</span><span class="p">,</span> <span class="s2">&quot;Invalid kind&quot;</span>

        <span class="c1"># Check if the quantum number information is for level or transition</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">qns</span><span class="p">)</span> <span class="ow">is</span> <span class="n">QuantumNumberRecord</span><span class="p">:</span>
            <span class="n">for_transitions</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">for_transitions</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">information</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">information</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span> <span class="ow">or</span> \
                       <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;QN&#39;</span><span class="p">,</span> <span class="s1">&#39;LM&#39;</span><span class="p">,</span> <span class="s1">&#39;PB&#39;</span><span class="p">],</span> \
                       <span class="s2">&quot;Unrecognized key&quot;</span>

        <span class="c1"># Looping over all the line data</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">):</span>

            <span class="c1"># If spec is None, then all species, otherwise this should match</span>
            <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
                        <span class="n">remove_these</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">continue</span>

            <span class="c1"># If afgl is None, then all isotopes, otherwise this should match</span>
            <span class="k">if</span> <span class="n">afgl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">afgl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
                        <span class="n">remove_these</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">continue</span>

            <span class="c1"># Test which levels match and which do not --- partial matching</span>
            <span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantumnumbers</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">qns</span>
            <span class="k">if</span> <span class="n">for_transitions</span><span class="p">:</span>
                <span class="n">test</span> <span class="o">=</span> <span class="p">[</span><span class="n">test</span><span class="p">]</span>  <span class="c1"># To let all and any work</span>

            <span class="c1"># Append lines to remove later (so indexing is not messed up)</span>
            <span class="k">if</span> <span class="n">remove</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
                <span class="n">remove_these</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">keep</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
                <span class="n">remove_these</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">keep</span> <span class="ow">or</span> <span class="n">remove</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Useless to continue past this point if nothing matches</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="ow">and</span> <span class="n">for_transitions</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># There should only be matches remaining but only QN info is level-</span>
            <span class="c1"># based so all other infromation must be perfect match</span>
            <span class="k">for</span> <span class="n">info_key</span> <span class="ow">in</span> <span class="n">information</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">information</span><span class="p">[</span><span class="n">info_key</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">info_key</span> <span class="o">==</span> <span class="s1">&#39;QN&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">for_transitions</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                        <span class="k">elif</span> <span class="n">add</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">info</span>
                        <span class="k">elif</span> <span class="n">sub</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">info</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Programmer error?&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">][</span><span class="s1">&#39;UP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                            <span class="k">elif</span> <span class="n">add</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">][</span><span class="s1">&#39;UP&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">info</span>
                            <span class="k">elif</span> <span class="n">sub</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">][</span><span class="s1">&#39;UP&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">info</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Programmer error?&quot;</span>
                        <span class="k">if</span> <span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">][</span><span class="s1">&#39;LO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                            <span class="k">elif</span> <span class="n">add</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">][</span><span class="s1">&#39;LO&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">info</span>
                            <span class="k">elif</span> <span class="n">sub</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;QN&#39;</span><span class="p">][</span><span class="s1">&#39;LO&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">info</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Programmer error?&quot;</span>
                <span class="k">elif</span> <span class="n">info_key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PB&#39;</span><span class="p">,</span> <span class="s1">&#39;LM&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">info_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                    <span class="k">elif</span> <span class="n">add</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="n">info</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">info_key</span><span class="p">]</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> \
                            <span class="s2">&quot;Can only add to matching type&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">info_key</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">info</span>
                    <span class="k">elif</span> <span class="n">sub</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="n">info</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">info_key</span><span class="p">]</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> \
                            <span class="s2">&quot;Can only sub from matching type&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">info_key</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">info</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Programmer error?&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">test</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">info_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                    <span class="k">elif</span> <span class="n">add</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">info_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">info</span>
                    <span class="k">elif</span> <span class="n">sub</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">info_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">info</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Programmer error?&quot;</span>

        <span class="c1"># Again, to not get into index problems, this loop is reversed</span>
        <span class="k">if</span> <span class="n">remove</span> <span class="ow">or</span> <span class="n">keep</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">remove_these</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_line</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove line at index from line record</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">key</span><span class="p">][:</span><span class="n">index</span><span class="p">]</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">key</span><span class="p">][(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>

        <span class="n">_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">_t</span><span class="p">[:</span><span class="n">index</span><span class="p">]</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">_t</span><span class="p">[(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dictionaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_sanity_</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cross_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">vmrs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">isotopologue_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">partition_functions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Provides an estimation of the cross-section in the provided</span>
<span class="sd">        frequency range</span>

<span class="sd">        Computes the following estimate (summing over all lines):</span>

<span class="sd">        .. math::</span>
<span class="sd">            \\sigma(f) = \\sum_{k=0}^{k=n-1}</span>
<span class="sd">            r_k S_{0, k}(T_0) K_1 K_2 \\frac{Q(T_0)}{Q(T)}</span>
<span class="sd">            \\frac{1 + g_k \\; p^2 + iy_k \\; p }{\\gamma_{D,k}\\sqrt{\\pi}}</span>
<span class="sd">            \\; F\\left(\\frac{f - f_{0,k} -  \\Delta f_k \\; p^2 -</span>
<span class="sd">            \\delta f_kp + i\\gamma_{p,k}p} {\\gamma_{D,k}}\\right),</span>

<span class="sd">        where there are n lines,</span>
<span class="sd">        r is the isotopologue ratio,</span>
<span class="sd">        S_0 is the line strength,</span>
<span class="sd">        K_1 is the boltzman level statistics,</span>
<span class="sd">        K_2 is the stimulated emission,</span>
<span class="sd">        Q is the partition sum, G is the second</span>
<span class="sd">        order line mixing coefficient,</span>
<span class="sd">        p is pressure,</span>
<span class="sd">        Y is the first order line mixing coefficient,</span>
<span class="sd">        f_0 is the line frequency,</span>
<span class="sd">        Delta-f is the second order line mixing frequency shift,</span>
<span class="sd">        delta-f is the first order pressure shift,</span>
<span class="sd">        gamma_p is the pressure broadening half width,</span>
<span class="sd">        gamma_D is the Doppler half width, and</span>
<span class="sd">        F is assumed to be the Faddeeva function</span>

<span class="sd">        Note 1: this is only meant for quick-and-dirty estimates.  If data is</span>
<span class="sd">        lacking, very simplistic assumptions are made to complete the</span>
<span class="sd">        calculations.</span>
<span class="sd">        Lacking VMR for a species assumes 1.0 vmr of the line species itself,</span>
<span class="sd">        lacking mass assumes dry air mass,</span>
<span class="sd">        lacking isotopologue ratios means assuming a ratio of unity,</span>
<span class="sd">        lacking partition functions means the calculations are performed at</span>
<span class="sd">        line temperatures,</span>
<span class="sd">        lacking frequency means computing 1000 frequencies from lowest</span>
<span class="sd">        frequency line minus its pressure broadening to the highest frequency</span>
<span class="sd">        line plus its pressure broadening,</span>
<span class="sd">        lacking pressure means computing at 1 ATM, and</span>
<span class="sd">        lacking temperature assumes atmospheric temperatures the same as the</span>
<span class="sd">        first line temperature.  If input f is None then the return</span>
<span class="sd">        is (f, sigma), else the return is (sigma)</span>

<span class="sd">        Warning: Use only as an estimation, this function is neither optimized</span>
<span class="sd">        and is only tested for a single species in arts-xml-data to be within</span>
<span class="sd">        1% of the ARTS computed value</span>

<span class="sd">        Parameters:</span>
<span class="sd">            temperature (float): Temperature [Kelvin]</span>

<span class="sd">            pressure (float): Pressure [Pascal]</span>

<span class="sd">            vmrs (dict-like): Volume mixing ratios.  See PressureBroadening for</span>
<span class="sd">            use [-]</span>

<span class="sd">            mass (dict-like): Mass of isotopologue [kg]</span>

<span class="sd">            isotopologue_ratios (dict-like):  Isotopologue ratios of the</span>
<span class="sd">            different species [-]</span>

<span class="sd">            partition_functions (dict-like):  Partition function estimator,</span>
<span class="sd">            should compute partition function by taking temperature as the only</span>
<span class="sd">            argument [-]</span>

<span class="sd">            f (ndarray): Frequency [Hz]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (f, xsec) or xsec depending on f</span>

<span class="sd">        Examples:</span>
<span class="sd">            Plot cross-section making no assumptions on the atmosphere or</span>
<span class="sd">            species, i.e., isotopologue ratios is 1 for all isotopologue</span>
<span class="sd">            (will not agree with ARTS)</span>

<span class="sd">            &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;O2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; (f, x) = cat.cross_section()</span>
<span class="sd">            &gt;&gt;&gt; plt.plot(f, x)</span>

<span class="sd">            Plot cross-sections by specifying limited information on the</span>
<span class="sd">            species (will agree reasonably with ARTS)</span>

<span class="sd">            &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">            &gt;&gt;&gt; cat = arts.xml.load(&#39;O2.xml&#39;).as_ARTSCAT5()</span>
<span class="sd">            &gt;&gt;&gt; cat.changeForQN(afgl=66, kind=&#39;keep&#39;)</span>
<span class="sd">            &gt;&gt;&gt; f, x = cat.cross_section(mass={&quot;O2-66&quot;: 31.9898*constants.amu},</span>
<span class="sd">                                         isotopologue_ratios={&quot;O2-66&quot;: 0.9953})</span>
<span class="sd">            &gt;&gt;&gt; plt.plot(f, x)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">temperature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">pressure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pressure</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">atm</span>

        <span class="k">if</span> <span class="n">vmrs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmrs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">mass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_f</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressurebroadening</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">compute_pressurebroadening_params</span><span class="p">(</span>
                    <span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">pressure</span><span class="p">,</span> <span class="n">vmrs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">f0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">f0</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressurebroadening</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">compute_pressurebroadening_params</span><span class="p">(</span>
                    <span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">pressure</span><span class="p">,</span> <span class="n">vmrs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">f1</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_f</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">isotopologue_ratios</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">isotopologue_ratios</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">partition_functions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">partition_functions</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Cross-section</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">):</span>
            <span class="n">spec_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> \
                          <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;afgl&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">spec_key</span> <span class="ow">in</span> <span class="n">mass</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">mass</span><span class="p">[</span><span class="n">spec_key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">molar_mass_dry_air</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">avogadro</span>
            <span class="n">gamma_D</span> <span class="o">=</span> \
                <span class="n">spectroscopy</span><span class="o">.</span><span class="n">doppler_broadening</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
                                                <span class="n">m</span><span class="p">)</span>
            <span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">Df</span><span class="p">,</span>
             <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linemixing</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">compute_linemixing_params</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

            <span class="p">(</span><span class="n">gamma_p</span><span class="p">,</span>
             <span class="n">delta_f</span><span class="p">)</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">pressurebroadening</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">compute_pressurebroadening_params</span><span class="p">(</span>
                <span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">vmrs</span><span class="p">)</span>

            <span class="n">K1</span> <span class="o">=</span> <span class="n">spectroscopy</span><span class="o">.</span><span class="n">boltzmann_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;elow&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
                                              <span class="n">temperature</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">K2</span> <span class="o">=</span> <span class="n">spectroscopy</span><span class="o">.</span><span class="n">stimulated_emission</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">temperature</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">spec_key</span> <span class="ow">in</span> <span class="n">partition_functions</span><span class="p">:</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="n">partition_functions</span><span class="p">[</span><span class="n">spec_key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span>

            <span class="k">if</span> <span class="n">spec_key</span> <span class="ow">in</span> <span class="n">isotopologue_ratios</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">isotopologue_ratios</span><span class="p">[</span><span class="n">spec_key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="n">S</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">K1</span> <span class="o">*</span> <span class="n">K2</span> <span class="o">*</span> \
                <span class="n">Q</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">Q</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

            <span class="n">lm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">G</span> <span class="o">*</span> <span class="n">pressure</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">pressure</span>
            <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">LineRecordData</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                 <span class="n">delta_f</span> <span class="o">-</span> <span class="n">Df</span> <span class="o">*</span> <span class="n">pressure</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">gamma_p</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma_D</span>
            <span class="n">sigma</span> <span class="o">+=</span> <span class="p">(</span><span class="n">S</span> <span class="o">*</span> <span class="p">(</span><span class="n">lm</span> <span class="o">*</span> <span class="n">_Faddeeva_</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma_D</span><span class="p">))</span><span class="o">.</span><span class="n">real</span>
        <span class="k">if</span> <span class="n">return_f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">sigma</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sigma</span>

    <span class="k">def</span> <span class="nf">write_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlwriter</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write an ARTSCAT5 object to an ARTS XML file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_ArrayOfLineRecord</span><span class="p">()</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">write_xml</span><span class="p">(</span><span class="n">xmlwriter</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span></div>


<div class="viewcode-block" id="Rational"><a class="viewcode-back" href="../../generated/pyarts.internals.Rational.html#pyarts.internals.Rational">[docs]</a><span class="k">class</span> <span class="nc">Rational</span><span class="p">(</span><span class="n">_R</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rational number</span>

<span class="sd">    This is a copy of fractions.Fraction with only the __repr__ function over-</span>
<span class="sd">    written to match ARTS style.  That is 3/2 is represented as such rather</span>
<span class="sd">    than as &quot;Fraction(3, 2)&quot;.  See original class for more information,</span>
<span class="sd">    limitations, and options</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Rational.__init__"><a class="viewcode-back" href="../../generated/pyarts.internals.Rational.html#pyarts.internals.Rational.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Rational</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
    <span class="n">_R</span><span class="o">.</span><span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__repr__</span></div>


<div class="viewcode-block" id="LineMixing"><a class="viewcode-back" href="../../generated/pyarts.internals.LineMixing.html#pyarts.internals.LineMixing">[docs]</a><span class="k">class</span> <span class="nc">LineMixing</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;LineMixing data as in ARTS</span>

<span class="sd">    Not fully feature-complete</span>

<span class="sd">    Used by ARTSCAT5 to estimated ARTSCAT-5 style line mixing in cross_section</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_none</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_first_order</span> <span class="o">=</span> <span class="s2">&quot;L1&quot;</span>
    <span class="n">_second_order</span> <span class="o">=</span> <span class="s2">&quot;L2&quot;</span>
    <span class="n">_lblrtm</span> <span class="o">=</span> <span class="s2">&quot;LL&quot;</span>
    <span class="n">_lblrtm_nonresonant</span> <span class="o">=</span> <span class="s2">&quot;NR&quot;</span>
    <span class="n">_for_band</span> <span class="o">=</span> <span class="s2">&quot;BB&quot;</span>
    <span class="n">_possible_kinds</span> <span class="o">=</span> <span class="p">[</span><span class="n">_none</span><span class="p">,</span> <span class="n">_first_order</span><span class="p">,</span> <span class="n">_second_order</span><span class="p">,</span> <span class="n">_lblrtm</span><span class="p">,</span>
                       <span class="n">_lblrtm_nonresonant</span><span class="p">,</span> <span class="n">_for_band</span><span class="p">]</span>

<div class="viewcode-block" id="LineMixing.__init__"><a class="viewcode-back" href="../../generated/pyarts.internals.LineMixing.html#pyarts.internals.LineMixing.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_manually_changed_data</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_sanity_</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_data_as_in_arts_</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_assert_sanity_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Data available for none-type&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_order</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Data mismatching first order&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_second_order</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;Data mismatching second order&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;Data mismatching LBLRTM data&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm_nonresonant</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Data mismatching LBLRTM data&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_band</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Data mismatching band data&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize data type at all&quot;</span>

    <span class="k">def</span> <span class="nf">_make_data_as_in_arts_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_band</span><span class="p">]:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_t0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_second_order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_t0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_g0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_f0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">_ip</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_g</span> <span class="o">=</span> <span class="n">_ip</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknown data type&quot;</span>

    <span class="k">def</span> <span class="nf">_revert_from_arts_to_data_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manually_changed_data</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_band</span><span class="p">]:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ey</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_second_order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ey</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eg</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ef</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;Mismatch between y and g&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="o">.</span><span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="o">.</span><span class="n">y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="o">.</span><span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknown data type&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revert_from_arts_to_data_</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;No Line-Mixing&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_possible_kinds</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize kind&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revert_from_arts_to_data_</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_possible_kinds</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize kind&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_data_as_in_arts_</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">kind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>

    <span class="nd">@kind</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">kind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_possible_kinds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">val</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">assert</span> <span class="n">found</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize kind&quot;</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_second_order</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_order</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize data type automatically&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_manually_changed_data</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">compute_linemixing_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the line mixing parameters for given temperature(s)</span>

<span class="sd">        Cross-section is found from summing all lines</span>

<span class="sd">        .. math::</span>
<span class="sd">            \\sigma(f) \\propto \\sum_{k=0}^{k=n-1}</span>
<span class="sd">            \\left[1 + G_k \\; p^2 + iY_k \\; p\\right] \\;</span>
<span class="sd">            F\\left(\\frac{f - f_{0,k} -  \\Delta f_k \\; p^2 -</span>
<span class="sd">            \\delta f_kp + i\\gamma_{p,k}p} {\\gamma_{D,k}}\\right),</span>

<span class="sd">        where k indicates line dependent variables.  This function returns</span>
<span class="sd">        the line mixing parameters G, Y, and Delta-f.  The non-line</span>
<span class="sd">        mixing parameters are gamma_D as the Doppler broadening,  gamma_p</span>
<span class="sd">        as the pressure broadening, f as frequency,</span>
<span class="sd">        f_0 as the line frequency, delta-f as the first order pressure induced</span>
<span class="sd">        frequency shift, and p as pressure.  The function F() is the</span>
<span class="sd">        Faddeeva function and gives the line shape.  Many scaling factors are</span>
<span class="sd">        ignored in the equation above...</span>

<span class="sd">        Note 1: that for no line mixing, this function returns all zeroes</span>

<span class="sd">        Developer note: the internal variables used emulates the theory for</span>
<span class="sd">        each type of allowed line mixing.  Thus it should be easy to extend</span>
<span class="sd">        this for other types and for partial derivatives</span>

<span class="sd">        Input:</span>
<span class="sd">            temperature (float or ndarray) in Kelvin</span>

<span class="sd">        Output:</span>
<span class="sd">            G(temperature), Delta-f(temperature), Y(temperature)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_band</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_order</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_t0</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ey</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lblrtm_nonresonant</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_second_order</span><span class="p">:</span>
            <span class="n">th</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t0</span> <span class="o">/</span> <span class="n">temperature</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_g0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g1</span> <span class="o">*</span> <span class="p">(</span><span class="n">th</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">th</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eg</span><span class="p">,</span> \
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_f0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f1</span> <span class="o">*</span> <span class="p">(</span><span class="n">th</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">th</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ef</span><span class="p">,</span> \
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span> <span class="o">*</span> <span class="p">(</span><span class="n">th</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">th</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ey</span></div>


<div class="viewcode-block" id="PressureBroadening"><a class="viewcode-back" href="../../generated/pyarts.internals.PressureBroadening.html#pyarts.internals.PressureBroadening">[docs]</a><span class="k">class</span> <span class="nc">PressureBroadening</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;PressureBroadening data as in ARTS</span>

<span class="sd">    Not fully feature-complete</span>

<span class="sd">    Used by ARTSCAT5 to estimated ARTSCAT-5 style pressure broadening in</span>
<span class="sd">    cross_section</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_none</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_air</span> <span class="o">=</span> <span class="s2">&quot;N2&quot;</span>
    <span class="n">_air_and_water</span> <span class="o">=</span> <span class="s2">&quot;WA&quot;</span>
    <span class="n">_all_planets</span> <span class="o">=</span> <span class="s2">&quot;AP&quot;</span>
    <span class="n">_sd_air</span> <span class="o">=</span> <span class="s2">&quot;SD-AIR&quot;</span>
    <span class="n">_possible_kinds</span> <span class="o">=</span> <span class="p">[</span><span class="n">_none</span><span class="p">,</span> <span class="n">_air</span><span class="p">,</span> <span class="n">_air_and_water</span><span class="p">,</span> <span class="n">_all_planets</span><span class="p">,</span> <span class="n">_sd_air</span><span class="p">]</span>

<div class="viewcode-block" id="PressureBroadening.__init__"><a class="viewcode-back" href="../../generated/pyarts.internals.PressureBroadening.html#pyarts.internals.PressureBroadening.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_manually_changed_data</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_sanity_</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_data_as_in_arts_</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_assert_sanity_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Data available for none-type&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;mismatching air broadening &quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air_and_water</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;mismatching air and water broadening&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_planets</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;mismatching all planets data&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sd_air</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;mismatching speed dependent air data&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize data type at all&quot;</span>

    <span class="k">def</span> <span class="nf">_make_data_as_in_arts_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_agam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_an</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_adel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_dsgam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dnself</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_dagam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dnair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_dadel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air_and_water</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_agam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_an</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_adel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_wgam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wdel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_planets</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;N2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                         <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                         <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_n</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;N2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
                       <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
                       <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">13</span><span class="p">]}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;N2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span>
                             <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span>
                             <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">19</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknown data type&quot;</span>

    <span class="k">def</span> <span class="nf">_revert_from_arts_to_data_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manually_changed_data</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_an</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adel</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dsgam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dnself</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dagam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dnair</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dadel</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air_and_water</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_an</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adel</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgam</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wn</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wdel</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_planets</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="s1">&#39;H2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="s1">&#39;H2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="s1">&#39;H2&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknown data type&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revert_from_arts_to_data_</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;No Pressure-Broadening&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_possible_kinds</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize kind&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revert_from_arts_to_data_</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_possible_kinds</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize kind&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_data_as_in_arts_</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">kind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>

    <span class="nd">@kind</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">kind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_possible_kinds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">val</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">assert</span> <span class="n">found</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize kind&quot;</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air_and_water</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_planets</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize data type automatically&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_manually_changed_data</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">compute_pressurebroadening_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">line_temperature</span><span class="p">,</span>
                                          <span class="n">pressure</span><span class="p">,</span> <span class="n">vmrs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the pressure broadening parameters for the given atmosphere</span>

<span class="sd">        Cross-section is found from summing all lines</span>

<span class="sd">        .. math::</span>
<span class="sd">            \\sigma(f) \\propto \\sum_{k=1}^{k=n-1}</span>
<span class="sd">            F\\left(\\frac{f - f_{0,k} -  \\Delta f_k \\; p^2 -</span>
<span class="sd">            \\delta f_kp + i\\gamma_{p,k}p} {\\gamma_{D,k}}\\right),</span>

<span class="sd">        where k indicates line dependent variables.  This function returns</span>
<span class="sd">        the pressure broadening parameters p*gamma_p and p*delta-f.  The non-</span>
<span class="sd">        pressure broadening parameters are gamma_D as the Doppler broadening,</span>
<span class="sd">        f as frequency, f_0 as the line frequency, delta-f as the first order</span>
<span class="sd">        pressure induced frequency shift, and p as pressure.  The function</span>
<span class="sd">        F() is the Faddeeva function and gives the line shape.  Many scaling</span>
<span class="sd">        factors are ignored in the equation above...</span>

<span class="sd">        The pressure broadening parameters are summed from the contribution of</span>
<span class="sd">        each individual perturber so that for i perturbers</span>

<span class="sd">        .. math::</span>
<span class="sd">            \\gamma_pp = \\sum_i \\gamma_{p,i} p_i</span>

<span class="sd">        and</span>

<span class="sd">        .. math::</span>
<span class="sd">            \\delta f_pp = \\sum_i \\delta f_{p,i} p_i</span>

<span class="sd">        Parameters:</span>
<span class="sd">            temperature (float or ndarray): Temperature [Kelvin]</span>

<span class="sd">            line_temperature (float): Line temperature [Kelvin]</span>

<span class="sd">            pressure (float or like temperature): Total pressure [Pascal]</span>

<span class="sd">            vmrs (dict):  Volume mixing ratio of atmospheric species.</span>
<span class="sd">            dict should be {&#39;self&#39;: self_vmr} for &#39;N2&#39;, {&#39;self&#39;: self_vmr,</span>
<span class="sd">            &#39;H2O&#39;: h2o_vmr} for kind &#39;WA&#39;, and each species of &#39;AP&#39; should be</span>
<span class="sd">            represented in the same manner.  When &#39;self&#39; is one of the list of</span>
<span class="sd">            species, then vmrs[&#39;self&#39;] should not exist.  Missing data is</span>
<span class="sd">            treated as a missing species.  No data at all is assumed to mean</span>
<span class="sd">            1.0 VMR of self (len(vmrs) == 0 must evaluate as True).  The</span>
<span class="sd">            internal self_vmr, h2o_vmr, etc., variables must have sime size</span>
<span class="sd">            as pressure or be constants</span>

<span class="sd">        Returns:</span>
<span class="sd">            p  gamma0_p, p  delta-f0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">line_temperature</span> <span class="o">/</span> <span class="n">temperature</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vmrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">*</span> <span class="n">pressure</span><span class="p">,</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span><span class="p">)</span> <span class="o">*</span> <span class="n">pressure</span>

        <span class="n">sum_vmrs</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">vmrs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">species</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                    <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">*</span> \
                        <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span><span class="p">)</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">sum_vmrs</span> <span class="o">+=</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
            <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_an</span> <span class="o">*</span> \
                <span class="n">pressure</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sum_vmrs</span><span class="p">)</span>
            <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adel</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_an</span><span class="p">)</span> <span class="o">*</span> \
                <span class="n">pressure</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sum_vmrs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air_and_water</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">vmrs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">species</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                    <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">*</span> \
                        <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span><span class="p">)</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">sum_vmrs</span> <span class="o">+=</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">species</span> <span class="o">==</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span>
                    <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wgam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wn</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wdel</span> <span class="o">*</span> \
                        <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wn</span><span class="p">)</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">sum_vmrs</span> <span class="o">+=</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
            <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_an</span> <span class="o">*</span> \
                <span class="n">pressure</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sum_vmrs</span><span class="p">)</span>
            <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adel</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_an</span><span class="p">)</span> <span class="o">*</span> \
                <span class="n">pressure</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sum_vmrs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_planets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">vmrs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">species</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                    <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sgam</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sdel</span> <span class="o">*</span> \
                        <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sn</span><span class="p">)</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">sum_vmrs</span> <span class="o">+=</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">species</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">:</span>
                    <span class="n">gamma</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gam</span><span class="p">[</span><span class="n">species</span><span class="p">]</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="n">species</span><span class="p">]</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">delta_f</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_f</span><span class="p">[</span><span class="n">species</span><span class="p">]</span> <span class="o">*</span> \
                        <span class="n">theta</span> <span class="o">**</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n</span><span class="p">[</span><span class="n">species</span><span class="p">])</span> <span class="o">*</span> \
                        <span class="n">pressure</span> <span class="o">*</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
                    <span class="n">sum_vmrs</span> <span class="o">+=</span> <span class="n">vmrs</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
            <span class="n">gamma</span> <span class="o">/=</span> <span class="n">sum_vmrs</span>
            <span class="n">delta_f</span> <span class="o">/=</span> <span class="n">sum_vmrs</span>
        <span class="k">return</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">delta_f</span></div>


<div class="viewcode-block" id="PartitionFunctions"><a class="viewcode-back" href="../../generated/pyarts.internals.PartitionFunctions.html#pyarts.internals.PartitionFunctions">[docs]</a><span class="k">class</span> <span class="nc">PartitionFunctions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class to compute partition functions given ARTS-like partition functions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_default_test</span> <span class="o">=</span> <span class="mf">296.0</span>

<div class="viewcode-block" id="PartitionFunctions.__init__"><a class="viewcode-back" href="../../generated/pyarts.internals.PartitionFunctions.html#pyarts.internals.PartitionFunctions.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">init_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_sanity_</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">SpeciesAuxData</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_from_species_aux_data_</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_from_dict_</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">PartitionFunctions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PartitionFunctions</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot recognize the initialization data type&quot;</span>

    <span class="k">def</span> <span class="nf">_from_species_aux_data_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sad</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">sad</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Must be version 2 data&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_from_dict_</span><span class="p">(</span><span class="n">sad</span><span class="o">.</span><span class="n">_data_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_from_dict_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">,</span> <span class="s2">&quot;lowest level data must be list&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_from_list_</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_from_list_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PART_TFIELD&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ip</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PART_COEFF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_P</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unknown or not implemented &quot;</span> <span class="o">+</span>
                               <span class="s2">&quot;partition_functions type encountered&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_assert_sanity_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">,</span> <span class="s2">&quot;Sanity check fail, calss is wrong&quot;</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_from_list_</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_ip</span><span class="o">.</span><span class="n">interp1d</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_test</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot determine type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;partition functions for &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; species&quot;</span>

    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">species</span> <span class="o">=</span> <span class="n">keys</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">,</span> <span class="s2">&quot;new values must be dictionary type&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">val</span></div>

<span class="kn">from</span> <span class="nn">.catalogues</span> <span class="kn">import</span> <span class="n">SpeciesAuxData</span>
<span class="kn">from</span> <span class="nn">.catalogues</span> <span class="kn">import</span> <span class="n">ArrayOfLineRecord</span>
<span class="kn">from</span> <span class="nn">.catalogues</span> <span class="kn">import</span> <span class="n">QuantumNumberRecord</span>
<span class="kn">from</span> <span class="nn">.utils.arts</span> <span class="kn">import</span> <span class="n">as_quantumnumbers</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The Typhon and ARTS Developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>